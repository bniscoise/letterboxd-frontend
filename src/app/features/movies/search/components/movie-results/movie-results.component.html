@if (loading) {
<div
  class="flex items-center justify-center gap-3 rounded-lg border border-dashed border-monokai-border bg-monokai-surface-highlight/60 py-6 text-monokai-muted"
>
  <div
    class="h-8 w-8 animate-spin rounded-full border-2 border-monokai-border border-t-monokai-accent"
  ></div>
  <span>Recherche en cours...</span>
</div>
} @if (!searchPerformed && !loading) {
<div
  class="rounded-lg border border-dashed border-monokai-border bg-monokai-surface-highlight/60 p-6 text-center text-sm text-monokai-muted"
>
  <p>Commencez par saisir le nom d'un film pour explorer la base de données.</p>
</div>
} @if (!loading && searchPerformed && movies.length === 0) {
<div
  class="rounded-lg border border-dashed border-monokai-border bg-monokai-surface-highlight/60 p-6 text-center text-sm text-monokai-muted"
>
  <p>Aucun résultat pour "{{ query }}"</p>
</div>
} @if (movies.length > 0) {
<ul class="space-y-4">
  @for (movie of pagedMovies; track trackById($index, movie)) {
  <li
    class="flex gap-5 rounded-xl border border-monokai-border bg-monokai-surface-highlight/70 p-5 shadow transition hover:shadow-monokai"
  >
    @if (movie.posterUrl) {
    <img
      [src]="movie.posterUrl"
      width="100"
      height="150"
      [alt]="movie.primaryTitle || movie.originalTitle"
      class="h-[150px] w-[100px] rounded object-cover shadow-inner"
    />
    } @else {
    <div
      class="flex h-[150px] w-[100px] items-center justify-center rounded border border-monokai-border bg-monokai-surface"
    >
      <span class="text-center text-xs text-monokai-muted">Pas d'image</span>
    </div>
    }

    <div class="flex-1 space-y-3">
      <div>
        <h3 class="text-xl font-semibold text-monokai-text">
          {{ movie.primaryTitle || movie.originalTitle }}
        </h3>
        <p class="text-sm uppercase tracking-wide text-monokai-muted">{{ movie.startYear }}</p>
      </div>

      @if (movie.aggregateRating !== undefined) {
      <p class="text-sm font-medium text-monokai-yellow">
        ⭐ {{ movie.aggregateRating }}/10 @if (movie.voteCount) {
        <span class="ml-1 text-xs text-monokai-muted">({{ movie.voteCount }} votes)</span>
        }
      </p>
      }
      <div class="flex justify-between items-center">
        <button
          class="px-4 py-3 bg-monokai-green rounded-lg text-monokai-background transition hover:bg-monokai-yellow hover:text-monokai-background"
          type="button"
          (click)="onAddMovie(movie)"
        >
          Ajouter à votre liste
        </button>
        <button
          class="px-4 py-3 bg-monokai-accent rounded-lg text-monokai-background transition hover:bg-monokai-yellow"
          type="button"
          (click)="onViewInformation(movie)"
        >
          Informations
        </button>
      </div>
    </div>
  </li>
  }
</ul>

@if (totalPages > 1) {
<nav class="mt-6 flex items-center justify-center gap-3 text-sm">
  <button
    class="rounded-lg border border-monokai-border bg-monokai-surface px-3 py-2 text-monokai-muted transition hover:text-monokai-text disabled:cursor-not-allowed disabled:opacity-50"
    (click)="onPreviousPage()"
    [disabled]="currentPage === 1"
  >
    Précédent
  </button>

  <div class="flex items-center gap-2">
    @for (page of pageNumbers; track $index) {
    <button
      class="min-w-[2.5rem] rounded-lg px-3 py-2 text-center transition"
      [ngClass]="{
        'bg-monokai-accent text-monokai-background shadow-monokai': page === currentPage,
        'border border-monokai-border bg-monokai-surface text-monokai-muted hover:text-monokai-text':
          page !== currentPage
      }"
      (click)="onGoToPage(page)"
    >
      {{ page }}
    </button>
    }
  </div>

  <button
    class="rounded-lg border border-monokai-border bg-monokai-surface px-3 py-2 text-monokai-muted transition hover:text-monokai-text disabled:cursor-not-allowed disabled:opacity-50"
    (click)="onNextPage()"
    [disabled]="currentPage === totalPages"
  >
    Suivant
  </button>
</nav>
} }
